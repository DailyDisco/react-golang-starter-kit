# ============================================
# React + Go Starter Kit - Environment Configuration
# ============================================
# This file is the reference template for all environment variables.
# Copy to .env for development or .env.prod for production.

# ============================================
# QUICK SETUP
# ============================================
# 1. Copy this file: cp .env.example .env
# 2. Generate a secure JWT secret: openssl rand -hex 32
# 3. Update database credentials if not using Docker defaults
# 4. Start the app: docker compose up -d

# ============================================
# 1. CORE APPLICATION SETTINGS
# ============================================

# Server port for the Go backend
API_PORT=8080

# Backend API URL (used by frontend)
VITE_API_URL=http://localhost:8080

# Environment mode: development, staging, or production
GO_ENV=development
NODE_ENV=development

# Enable debug mode (set to false in production)
DEBUG=true

# ============================================
# 2. DATABASE CONFIGURATION
# ============================================

# PostgreSQL connection settings
DB_HOST=localhost
DB_PORT=5432
DB_USER=devuser
DB_PASSWORD=devpass
DB_NAME=devdb

# SSL mode: disable (dev), require (prod)
DB_SSLMODE=disable

# Connection Pool Settings (optional - sensible defaults provided)
# Tune these for production workloads
# DB_POOL_MAX_CONNS=25
# DB_POOL_MIN_CONNS=5
# DB_POOL_MAX_CONN_LIFETIME_MINUTES=5
# DB_POOL_MAX_CONN_IDLE_TIME_MINUTES=1
# DB_POOL_HEALTH_CHECK_SECONDS=30

# ============================================
# 3. AUTHENTICATION & SECURITY
# ============================================

# JWT secret key - CHANGE THIS IN PRODUCTION!
# Generate with: openssl rand -hex 32
JWT_SECRET=dev-jwt-secret-key-for-development-only-change-in-production

# JWT token expiration (hours)
JWT_EXPIRATION_HOURS=24

# Cookie SameSite mode: lax (default) or strict
# Use strict for maximum CSRF protection
# COOKIE_SAMESITE=lax

# CSRF Protection
# Enable/disable CSRF protection (enabled by default)
# CSRF_ENABLED=true

# Use secure cookies in production (with HTTPS)
# CSRF_COOKIE_SECURE=true

# Cookie domain (leave empty for current domain)
# CSRF_COOKIE_DOMAIN=

# SameSite mode: strict, lax, or none
# CSRF_COOKIE_SAMESITE=strict

# Token Blacklist Fail Mode
# Controls behavior when token blacklist check fails (DB error):
# - "open" (default): Allow request on error (availability-first)
# - "closed": Deny request on error (security-first, use in high-security environments)
# TOKEN_BLACKLIST_FAIL_MODE=open

# ============================================
# 4. CORS CONFIGURATION
# ============================================

# Allowed origins (comma-separated)
# Use specific URLs in production, not wildcards
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5193,http://localhost:8080

# ============================================
# 5. RATE LIMITING
# ============================================

# Enable/disable rate limiting
RATE_LIMIT_ENABLED=true

# Rate limits use sensible defaults if not specified.
# Uncomment to customize:

# General API endpoints
# RATE_LIMIT_GENERAL_REQUESTS=100
# RATE_LIMIT_GENERAL_WINDOW=1m

# Authentication endpoints (stricter)
# RATE_LIMIT_AUTH_REQUESTS=5
# RATE_LIMIT_AUTH_WINDOW=1m

# Public endpoints (more lenient)
# RATE_LIMIT_PUBLIC_REQUESTS=1000
# RATE_LIMIT_PUBLIC_WINDOW=1h

# ============================================
# 6. LOGGING CONFIGURATION
# ============================================

# Enable logging
LOG_ENABLED=true

# Log level: debug, info, warn, error
LOG_LEVEL=info

# Pretty print logs (disable in production for JSON output)
LOG_PRETTY=true

# Advanced logging options (uncomment to customize):
# LOG_INCLUDE_USER_CONTEXT=false
# LOG_INCLUDE_REQUEST_BODY=false
# LOG_INCLUDE_RESPONSE_BODY=false
# LOG_MAX_REQUEST_BODY_SIZE=1024
# LOG_MAX_RESPONSE_BODY_SIZE=1024
# LOG_SAMPLING_RATE=1.0
# LOG_ASYNC=false
# LOG_SANITIZE_HEADERS=true
# LOG_FILTER_SENSITIVE_DATA=true
# LOG_ALLOWED_HEADERS=Authorization,Content-Type
# LOG_TIME_FORMAT=2006-01-02T15:04:05Z07:00

# ============================================
# 7. CACHING CONFIGURATION
# ============================================

# Enable caching for improved performance
# CACHE_ENABLED=true

# Cache type: redis (recommended for prod) or memory (for dev)
# CACHE_TYPE=memory

# Redis connection (individual settings)
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0
# REDIS_REQUIRED=false

# Redis connection (URL format - alternative)
# REDIS_URL=redis://localhost:6379/0

# Redis pool settings
# REDIS_POOL_SIZE=10
# REDIS_MIN_IDLE_CONNS=2
# REDIS_MAX_IDLE_CONNS=5

# Memory cache settings
# CACHE_MEMORY_MAX_SIZE=10000

# Cache TTL settings (seconds)
# CACHE_DEFAULT_TTL=300
# CACHE_USER_PROFILE_TTL=120
# CACHE_SESSION_TTL=900
# CACHE_HEALTH_CHECK_TTL=30

# Cache key prefix for namespacing
# CACHE_KEY_PREFIX=app

# ============================================
# 8. FILE STORAGE (AWS S3)
# ============================================

# By default, files are stored in PostgreSQL.
# Configure AWS S3 for scalable cloud storage.

# AWS_ACCESS_KEY_ID=your-aws-access-key
# AWS_SECRET_ACCESS_KEY=your-aws-secret-key
# AWS_REGION=us-east-1
# AWS_S3_BUCKET=your-bucket-name

# File upload limits
# MAX_FILE_SIZE_MB=10

# ============================================
# 9. DATABASE MIGRATIONS
# ============================================

# Auto-run migrations on startup (recommended for development)
# RUN_MIGRATIONS=false

# Path to migration files
# MIGRATIONS_PATH=./migrations

# ============================================
# 10. BACKGROUND JOBS (River)
# ============================================

# Enable background job processing
# JOBS_ENABLED=true

# Number of worker goroutines
# JOBS_WORKER_COUNT=10

# Maximum retry attempts for failed jobs
# JOBS_MAX_RETRIES=3

# Job timeout duration
# JOBS_TIMEOUT=30s

# ============================================
# 11. EMAIL SERVICE (SMTP)
# ============================================

# Enable email sending
EMAIL_ENABLED=false

# SMTP Configuration
SMTP_HOST=smtp.resend.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_TLS=true

# Email sender configuration
SMTP_FROM=noreply@yourapp.com
SMTP_FROM_NAME=Your App Name

# Frontend URL (for email links)
FRONTEND_URL=http://localhost:5193

# Development mode (logs emails instead of sending)
# EMAIL_DEV_MODE=false

# Support email shown in templates
# EMAIL_SUPPORT=support@yourapp.com

# ============================================
# 12. STRIPE PAYMENTS
# ============================================

# Enable Stripe integration
# STRIPE_ENABLED=true

# API Keys (get from dashboard.stripe.com)
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key

# Webhook secret (get from Stripe CLI: stripe listen --forward-to localhost:8080/api/webhooks/stripe)
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret

# Checkout redirect URLs
STRIPE_SUCCESS_URL=http://localhost:5193/billing/success
STRIPE_CANCEL_URL=http://localhost:5193/billing/cancel
STRIPE_PORTAL_RETURN_URL=http://localhost:5193/billing

# Premium subscription price ID (from Stripe Dashboard)
# STRIPE_PREMIUM_PRICE_ID=price_1234567890

# ============================================
# 13. OTHER EXTERNAL SERVICES (Optional)
# ============================================

# --- PayPal ---
# PAYPAL_CLIENT_ID=your-paypal-client-id
# PAYPAL_CLIENT_SECRET=your-paypal-client-secret
# PAYPAL_MODE=sandbox

# --- AI/ML Services ---
# Google AI (Gemini)
# GOOGLE_AI_API_KEY=your-google-ai-api-key
# GEMINI_MODEL=gemini-2.0-flash-lite

# OpenAI
# OPENAI_API_KEY=your-openai-api-key
# OPENAI_MODEL=gpt-4

# --- Analytics & Monitoring ---
# Google Analytics
# GA_TRACKING_ID=UA-XXXXXXXXX-X

# Sentry Error Tracking (Backend)
# Get your DSN from https://sentry.io
# SENTRY_DSN=https://your-sentry-dsn
# SENTRY_ENVIRONMENT=development
# SENTRY_DEBUG=false
# APP_VERSION=1.0.0

# Sentry Error Tracking (Frontend)
# Uses Vite environment variables
# VITE_SENTRY_DSN=https://your-frontend-sentry-dsn
# VITE_SENTRY_ENABLE_DEV=false
# VITE_APP_VERSION=1.0.0

# PostHog Analytics
# POSTHOG_API_KEY=your-posthog-api-key
# POSTHOG_HOST=https://app.posthog.com

# ============================================
# 14. DEPLOYMENT NOTES
# ============================================

# Railway PostgreSQL (provided automatically)
# PGHOST=your-railway-host.railway.internal
# PGPORT=5432
# PGUSER=postgres
# PGPASSWORD=your-railway-password
# PGDATABASE=railway

# Server timeout for long-running requests
# SERVER_TIMEOUT=30s

# ============================================
# PRODUCTION SECURITY CHECKLIST
# ============================================
# Complete ALL items before deploying to production:
#
# Authentication & Secrets:
# [ ] Generate secure JWT_SECRET: openssl rand -hex 32
# [ ] Rotate any development credentials
#
# Database:
# [ ] Set DB_SSLMODE=require
# [ ] Use strong database password
#
# Security Headers:
# [ ] Set CSRF_COOKIE_SECURE=true (requires HTTPS)
# [ ] Set SECURITY_HSTS_ENABLED=true (requires HTTPS)
# [ ] Review CORS_ALLOWED_ORIGINS (no wildcards)
#
# Application:
# [ ] Set DEBUG=false
# [ ] Set GO_ENV=production
# [ ] Set NODE_ENV=production
# [ ] Set LOG_PRETTY=false (for JSON logs)
#
# Monitoring:
# [ ] Configure SENTRY_DSN for error tracking
# [ ] Set up log aggregation (CloudWatch, Datadog, etc.)
# [ ] Configure alerting for errors and anomalies
#
# Rate Limiting:
# [ ] Review rate limits for production traffic
# [ ] Consider stricter auth endpoint limits
