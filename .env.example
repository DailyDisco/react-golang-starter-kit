# ============================================
# React + Go Starter Kit - Environment Configuration
# ============================================
# This file is the single source of truth for all environment variables.
# Copy to .env for development: cp .env.example .env

# ============================================
# QUICK SETUP
# ============================================
# 1. Copy this file: cp .env.example .env
# 2. Generate a secure JWT secret: openssl rand -hex 32
# 3. Start the app: docker compose up -d

# ============================================
# 1. CORE APPLICATION SETTINGS
# ============================================

# Server configuration
API_PORT=8080
API_HOST=0.0.0.0

# Environment mode: development, staging, or production
GO_ENV=development

# Enable debug mode (set to false in production)
DEBUG=true

# Server timeout for requests
# SERVER_TIMEOUT=30s

# ============================================
# 2. DATABASE CONFIGURATION
# ============================================

# PostgreSQL connection (Railway-style PG* vars take priority)
# For local development, use DB_* vars
# For production (Railway), set PG* vars

# Local development settings
DB_HOST=localhost
DB_PORT=5432
DB_USER=devuser
DB_PASSWORD=devpass
DB_NAME=starter_kit_db
DB_SSLMODE=disable

# Railway PostgreSQL (production) - these override DB_* vars if set
# PGHOST=your-railway-host.railway.internal
# PGPORT=5432
# PGUSER=postgres
# PGPASSWORD=your-railway-password
# PGDATABASE=railway

# Connection Pool Settings
# DB_POOL_MAX_CONNS=25
# DB_POOL_MIN_CONNS=5
# DB_POOL_MAX_CONN_LIFETIME_MINUTES=5
# DB_POOL_MAX_CONN_IDLE_TIME_MINUTES=1
# DB_POOL_HEALTH_CHECK_SECONDS=30

# Query Profiling
# DB_SLOW_QUERY_THRESHOLD=100ms
# DB_LOG_ALL_QUERIES=false

# ============================================
# 3. AUTHENTICATION & SECURITY
# ============================================

# JWT secret key - REQUIRED! Generate with: openssl rand -hex 32
JWT_SECRET=dev-jwt-secret-key-change-in-production

# Token expiration settings
# JWT_EXPIRATION_HOURS=24
# ACCESS_TOKEN_EXPIRATION_MINUTES=15
# REFRESH_TOKEN_EXPIRATION_DAYS=7

# Cookie settings
# COOKIE_SAMESITE=lax

# Token blacklist behavior on DB error: "open" (allow) or "closed" (deny)
# TOKEN_BLACKLIST_FAIL_MODE=open

# CSRF Protection
# CSRF_ENABLED=true
# CSRF_COOKIE_SECURE=false
# CSRF_COOKIE_DOMAIN=
# CSRF_COOKIE_SAMESITE=strict

# Security Headers
# SECURITY_HEADERS_ENABLED=true
# SECURITY_CSP=default-src 'self'
# SECURITY_FRAME_OPTIONS=DENY
# SECURITY_HSTS_ENABLED=false
# SECURITY_REFERRER_POLICY=strict-origin-when-cross-origin
# SECURITY_PERMISSIONS_POLICY=

# TOTP/2FA
# TOTP_ISSUER=YourAppName
# SITE_NAME=YourAppName
# TOTP_ENCRYPTION_KEY=your-32-byte-key

# ============================================
# 4. CORS CONFIGURATION
# ============================================

# Allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5193,http://localhost:4193,http://localhost:8080

# WebSocket allowed origins (uses CORS_ALLOWED_ORIGINS if not set)
# ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5193

# ============================================
# 5. RATE LIMITING
# ============================================

RATE_LIMIT_ENABLED=true

# IP-based limits
# RATE_LIMIT_IP_PER_MINUTE=60
# RATE_LIMIT_IP_PER_HOUR=1000
# RATE_LIMIT_IP_BURST_SIZE=10

# User-based limits
# RATE_LIMIT_USER_PER_MINUTE=100
# RATE_LIMIT_USER_PER_HOUR=2000
# RATE_LIMIT_USER_BURST_SIZE=20

# Auth endpoint limits (stricter)
# RATE_LIMIT_AUTH_PER_MINUTE=5
# RATE_LIMIT_AUTH_PER_HOUR=100
# RATE_LIMIT_AUTH_BURST_SIZE=2

# API endpoint limits
# RATE_LIMIT_API_PER_MINUTE=100
# RATE_LIMIT_API_PER_HOUR=2000
# RATE_LIMIT_API_BURST_SIZE=20

# Trusted proxies (comma-separated CIDRs)
# RATE_LIMIT_TRUSTED_PROXIES=

# ============================================
# 6. LOGGING CONFIGURATION
# ============================================

LOG_ENABLED=true
LOG_LEVEL=info
LOG_PRETTY=true

# Advanced logging options
# LOG_INCLUDE_USER_CONTEXT=false
# LOG_INCLUDE_REQUEST_BODY=false
# LOG_INCLUDE_RESPONSE_BODY=false
# LOG_MAX_REQUEST_BODY_SIZE=1024
# LOG_MAX_RESPONSE_BODY_SIZE=1024
# LOG_SAMPLING_RATE=1.0
# LOG_ASYNC=false
# LOG_SANITIZE_HEADERS=true
# LOG_FILTER_SENSITIVE=true
# LOG_ALLOWED_HEADERS=Authorization,Content-Type
# LOG_TIME_FORMAT=2006-01-02T15:04:05Z07:00

# ============================================
# 7. CACHING CONFIGURATION
# ============================================

# CACHE_ENABLED=true
# CACHE_TYPE=memory
# CACHE_KEY_PREFIX=app

# Redis connection (URL format)
# REDIS_URL=redis://localhost:6379/0

# Redis connection (individual settings)
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0
# REDIS_REQUIRED=false

# Redis pool settings
# REDIS_POOL_SIZE=10
# REDIS_MIN_IDLE_CONNS=2
# REDIS_MAX_IDLE_CONNS=5

# Memory cache settings
# CACHE_MEMORY_MAX_SIZE=10000

# Cache TTL settings (seconds)
# CACHE_DEFAULT_TTL=300
# CACHE_HEALTH_CHECK_TTL=30
# CACHE_USER_PROFILE_TTL=120
# CACHE_SESSION_TTL=900

# ============================================
# 8. FILE STORAGE
# ============================================

# Max file upload size in MB
MAX_FILE_SIZE_MB=10

# AWS S3 (optional - files stored in PostgreSQL by default)
# AWS_ACCESS_KEY_ID=your-aws-access-key
# AWS_SECRET_ACCESS_KEY=your-aws-secret-key
# AWS_REGION=us-east-1
# AWS_S3_BUCKET=your-bucket-name

# ============================================
# 9. DATABASE MIGRATIONS
# ============================================

# Auto-run migrations on startup
# RUN_MIGRATIONS=false
# MIGRATIONS_PATH=./migrations

# ============================================
# 10. BACKGROUND JOBS (River)
# ============================================

# JOBS_ENABLED=true
# JOBS_WORKER_COUNT=10
# JOBS_MAX_RETRIES=3
# JOBS_TIMEOUT=30s

# Metrics retention job
# METRICS_RETENTION_ENABLED=true
# METRICS_RETENTION_DAYS=30

# ============================================
# 11. EMAIL SERVICE (SMTP)
# ============================================

EMAIL_ENABLED=false

# SMTP Configuration
SMTP_HOST=smtp.resend.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
# SMTP_TLS_POLICY=opportunistic

# Email sender configuration
SMTP_FROM=noreply@yourapp.com
SMTP_FROM_NAME=Your App Name

# Frontend URL (for email links)
FRONTEND_URL=http://localhost:5193

# Development mode (logs emails instead of sending)
# EMAIL_DEV_MODE=true

# ============================================
# 12. OAUTH PROVIDERS
# ============================================

# Google OAuth
# GOOGLE_CLIENT_ID=your-google-client-id
# GOOGLE_CLIENT_SECRET=your-google-client-secret

# GitHub OAuth
# GITHUB_CLIENT_ID=your-github-client-id
# GITHUB_CLIENT_SECRET=your-github-client-secret

# OAuth redirect base URL (defaults to FRONTEND_URL)
# OAUTH_REDIRECT_BASE_URL=http://localhost:5193

# ============================================
# 13. STRIPE PAYMENTS
# ============================================

# STRIPE_ENABLED=false

# API Keys (get from dashboard.stripe.com)
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key

# Webhook secret (stripe listen --forward-to localhost:8080/api/webhooks/stripe)
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret

# Checkout redirect URLs
STRIPE_SUCCESS_URL=http://localhost:5193/billing/success
STRIPE_CANCEL_URL=http://localhost:5193/billing/cancel
STRIPE_PORTAL_RETURN_URL=http://localhost:5193/billing

# Premium subscription price ID
# STRIPE_PREMIUM_PRICE_ID=price_1234567890

# ============================================
# 14. AI SERVICES (Gemini)
# ============================================

GEMINI_ENABLED=false
# GEMINI_API_KEY=your-gemini-api-key
GEMINI_MODEL=gemini-2.0-flash
GEMINI_EMBEDDING_MODEL=text-embedding-004
# GEMINI_MAX_TOKENS=8192
# GEMINI_TIMEOUT_SECONDS=30
# GEMINI_MAX_IMAGE_SIZE_MB=10

# Safety settings (none, low, medium, high, block_all)
# GEMINI_SAFETY_LEVEL=medium

# Input validation limits
# GEMINI_MAX_PROMPT_LENGTH=100000
# GEMINI_MAX_MESSAGES_PER_CHAT=50
# GEMINI_MAX_TEXTS_PER_EMBED=100

# Feature flags
# GEMINI_ALLOW_FUNCTION_CALLING=true
# GEMINI_ALLOW_JSON_MODE=true

# AI-specific rate limiting (more restrictive to control costs)
# RATE_LIMIT_AI_PER_MINUTE=20
# RATE_LIMIT_AI_PER_HOUR=200
# RATE_LIMIT_AI_BURST_SIZE=5

# ============================================
# 15. MONITORING & ERROR TRACKING
# ============================================

# Sentry (Backend)
# SENTRY_DSN=https://your-sentry-dsn
# SENTRY_ENVIRONMENT=development
# SENTRY_DEBUG=false
# APP_VERSION=1.0.0

# ============================================
# 16. FRONTEND (Vite)
# ============================================

# API URL (leave empty to use Vite proxy, or set absolute URL)
VITE_API_URL=

# Sentry (Frontend)
# VITE_SENTRY_DSN=https://your-frontend-sentry-dsn
# VITE_SENTRY_ENABLE_DEV=false
# VITE_APP_VERSION=1.0.0

# Feature Flags (override defaults from feature-flags-provider.tsx)
# VITE_FEATURE_NEW_DASHBOARD_LAYOUT=true
# VITE_FEATURE_BETA_ANALYTICS=false
# VITE_FEATURE_ADVANCED_FILE_UPLOAD=true
# VITE_FEATURE_USER_ROLES_MANAGEMENT=false
# VITE_FEATURE_DARK_MODE_TOGGLE=true
# VITE_FEATURE_EXPERIMENTAL_CHARTS=false

# Debug settings
# VITE_ENABLE_DEVTOOLS=true
# VITE_DEBUG_MODE=false

# ============================================
# 17. DATABASE SEEDING (Development Only)
# ============================================

# Auto-seed on startup (only works in development/test)
AUTO_SEED=true
SEED_ADMIN_PASSWORD=admin123!
SEED_DEFAULT_PASSWORD=password123!

# ============================================
# PRODUCTION CHECKLIST
# ============================================
# Complete ALL items before deploying:
#
# Authentication & Secrets:
# [ ] Generate secure JWT_SECRET: openssl rand -hex 32
# [ ] Set strong TOTP_ENCRYPTION_KEY
# [ ] Rotate any development credentials
#
# Database:
# [ ] Set DB_SSLMODE=require
# [ ] Use strong database password
# [ ] Configure connection pooling
#
# Security:
# [ ] Set CSRF_COOKIE_SECURE=true (requires HTTPS)
# [ ] Set SECURITY_HSTS_ENABLED=true (requires HTTPS)
# [ ] Review CORS_ALLOWED_ORIGINS (specific URLs only)
#
# Application:
# [ ] Set DEBUG=false
# [ ] Set GO_ENV=production
# [ ] Set LOG_PRETTY=false (for JSON logs)
# [ ] Set AUTO_SEED=false
#
# Monitoring:
# [ ] Configure SENTRY_DSN for error tracking
# [ ] Set up log aggregation
